# ุฏููู ุงุฎุชุจุงุฑ ููุงููุงุช ุงูููุฏูู ูู ุชุทุจูู Flutter

## ูุชุทูุจุงุช ุงูุงุฎุชุจุงุฑ

### 1. ุฅุนุฏุงุฏุงุช Agora ูู ุงูุจุงููุฏ

ูุจู ุงูุจุฏุกุ ูุฌุจ ุงูุชุฃูุฏ ูู ุฅุนุฏุงุฏ Agora ูู ุงูุจุงููุฏ:

#### ุฃ) ุงูุญุตูู ุนูู ุจูุงูุงุช Agora
1. ุณุฌู ุฏุฎููู ุฅูู [Agora Console](https://console.agora.io)
2. ุฃูุดุฆ ูุดุฑูุน ุฌุฏูุฏ ุฃู ุงุฎุชุฑ ูุดุฑูุน ููุฌูุฏ
3. ุงูุณุฎ **App ID** ู **App Certificate**

#### ุจ) ุฅุนุฏุงุฏ ุงูุจูุงูุงุช ูู ุงูุจุงููุฏ
ุงุณุชุฎุฏู Swagger ุฃู Admin Dashboard:

```bash
PATCH /v1/admin/settings/agora
Headers: Authorization: Bearer {admin_token}
Body: {
  "appId": "YOUR_AGORA_APP_ID",
  "appCertificate": "YOUR_AGORA_APP_CERTIFICATE",
  "tokenExpirationTime": 3600,
  "isEnabled": true
}
```

#### ุฌ) ุงุฎุชุจุงุฑ ุงูุงุชุตุงู
```bash
POST /v1/admin/settings/agora/test
Headers: Authorization: Bearer {admin_token}
```

ูุฌุจ ุฃู ุชุญุตู ุนูู:
```json
{
  "success": true,
  "message": "Agora connection test successful"
}
```

### 2. ุฅุนุฏุงุฏุงุช ุงูุชุทุจูู

#### ุฃ) ุชุซุจูุช ุงูุญุฒู
```bash
cd patien_app
flutter pub get
```

#### ุจ) ุงูุชุฃูุฏ ูู ุฅุนุฏุงุฏุงุช API
ุชุญูู ูู `lib/config/api_config.dart`:
- ุชุฃูุฏ ูู ุฃู `baseUrl` ูุดูุฑ ุฅูู ุงูุจุงููุฏ ุงูุตุญูุญ
- ููุชุทููุฑ ุงููุญูู: `http://localhost:3000/v1` ุฃู `http://10.0.2.2:3000/v1` (ููู Android Emulator)

### 3. ุชุดุบูู ุงูุชุทุจูู

#### ุฃ) ููู Android
```bash
flutter run
```

ุฃู ุญุฏุฏ ุฌูุงุฒ ูุญุฏุฏ:
```bash
flutter devices
flutter run -d <device_id>
```

#### ุจ) ููู iOS
```bash
flutter run -d ios
```

**ููุงุญุธุฉ ูููุฉ**: ููุงุฎุชุจุงุฑ ุนูู iOSุ ุณุชุญุชุงุฌ ุฅูู Mac ู Xcode.

## ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ

### ุงูุณููุงุฑูู 1: ุงุฎุชุจุงุฑ ุฃุณุงุณู ูููุงููุฉ ุงูููุฏูู

#### ุงูุฎุทูุงุช:
1. **ุฅูุดุงุก ููุนุฏ ูู ููุน VIDEO**
   - ุณุฌู ุฏุฎูู ูุทุจูุจ ุฃู ูุฑูุถ
   - ุฃูุดุฆ ููุนุฏ ุฌุฏูุฏ
   - ุงุฎุชุฑ ููุน ุงูููุนุฏ: **VIDEO**
   - ุงุฎุชุฑ ููุช ูู ุงููุณุชูุจู (ุนูู ุงูุฃูู 10 ุฏูุงุฆู ูู ุงูุขู)

2. **ุชุฃููุฏ ุงูููุนุฏ**
   - ุฅุฐุง ููุช ุทุจูุจุ ุฃูุฏ ุงูููุนุฏ
   - ุชุฃูุฏ ูู ุฃู ุญุงูุฉ ุงูููุนุฏ = **CONFIRMED**

3. **ุงูุงูุชุธุงุฑ ุญุชู 10 ุฏูุงุฆู ูุจู ุงูููุนุฏ**
   - ูุฌุจ ุฃู ูุธูุฑ ุฒุฑ "ุจุฏุก ููุงููุฉ ุงูููุฏูู" ูู ุดุงุดุฉ ุชูุงุตูู ุงูููุนุฏ
   - ุงูุฒุฑ ูุธูุฑ ููุท ุนูุฏูุง:
     - ููุน ุงูููุนุฏ = VIDEO
     - ุญุงูุฉ ุงูููุนุฏ = CONFIRMED
     - ุงูููุช ุจูู (T-10 ุฏูุงุฆู) ุฅูู ุงูุชูุงุก ุงูููุนุฏ

4. **ุจุฏุก ุงูููุงููุฉ**
   - ุงุถุบุท ุนูู ุฒุฑ "ุจุฏุก ููุงููุฉ ุงูููุฏูู"
   - ูุฌุจ ุฃู ุชุธูุฑ ุดุงุดุฉ ุงูููุงููุฉ
   - ูุฌุจ ุฃู ุชุฑู ุงูููุฏูู ุงููุญูู (ุฃูุช) ูู ุงูุฒุงููุฉ ุงูุนูููุฉ

5. **ุงูุงูุถูุงู ูู ุฌูุงุฒ ุขุฎุฑ**
   - ุงูุชุญ ุงูุชุทุจูู ุนูู ุฌูุงุฒ ุขุฎุฑ (ุฃู ูุญุงูู ุขุฎุฑ)
   - ุณุฌู ุฏุฎูู ูุงููุณุชุฎุฏู ุงูุขุฎุฑ (ุทุจูุจ/ูุฑูุถ)
   - ุงูุชุญ ููุณ ุงูููุนุฏ
   - ุงุถุบุท "ุจุฏุก ููุงููุฉ ุงูููุฏูู"
   - ูุฌุจ ุฃู ูุธูุฑ ุงูููุฏูู ุงูุจุนูุฏ ูู ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉ

### ุงูุณููุงุฑูู 2: ุงุฎุชุจุงุฑ ุงูุชุญูู ูู ุงูููุงููุฉ

#### ุงูุฎุทูุงุช:
1. **ูุชู/ุฅูุบุงุก ูุชู ุงููููุฑูููู**
   - ุงุถุบุท ุนูู ุฒุฑ ุงููููุฑูููู
   - ูุฌุจ ุฃู ูุชุบูุฑ ููู ุงูุฒุฑ ุฅูู ุงูุฃุญูุฑ ุนูุฏ ุงููุชู
   - ูุฌุจ ุฃู ูุธูุฑ ุฃููููุฉ mic_off ูู ุงูููุฏูู ุงููุญูู

2. **ุชุดุบูู/ุฅููุงู ุงููุงููุฑุง**
   - ุงุถุบุท ุนูู ุฒุฑ ุงููุงููุฑุง
   - ูุฌุจ ุฃู ุชุชููู ุงููุงููุฑุง ุนูุฏ ุงูุฅููุงู
   - ูุฌุจ ุฃู ูุธูุฑ ุฃููููุฉ videocam_off ูู ุงูููุฏูู ุงููุญูู

3. **ุชุจุฏูู ุงููุงููุฑุง**
   - ุงุถุบุท ุนูู ุฒุฑ ุชุจุฏูู ุงููุงููุฑุง
   - ูุฌุจ ุฃู ุชูุชูู ุงููุงููุฑุง ูู ุงูุฃูุงููุฉ ุฅูู ุงูุฎูููุฉ ุฃู ุงูุนูุณ

4. **ุฅููุงุก ุงูููุงููุฉ**
   - ุงุถุบุท ุนูู ุฒุฑ "ุฅููุงุก"
   - ูุฌุจ ุฃู ูุธูุฑ ุชุฃููุฏ
   - ุนูุฏ ุงูุชุฃููุฏุ ูุฌุจ ุฃู ุชุนูุฏ ูุดุงุดุฉ ุชูุงุตูู ุงูููุนุฏ

### ุงูุณููุงุฑูู 3: ุงุฎุชุจุงุฑ ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก

#### ุฃ) ุงุฎุชุจุงุฑ ุจุฏูู ุฅุนุฏุงุฏุงุช Agora
1. ุนุทู Agora ูู ุงูุจุงููุฏ (`isEnabled: false`)
2. ุญุงูู ุจุฏุก ููุงููุฉ
3. ูุฌุจ ุฃู ุชุธูุฑ ุฑุณุงูุฉ ุฎุทุฃ ูุงุถุญุฉ

#### ุจ) ุงุฎุชุจุงุฑ ูุจู ุงูููุช ุงููุญุฏุฏ
1. ุญุงูู ุจุฏุก ููุงููุฉ ูุจู 10 ุฏูุงุฆู ูู ุงูููุนุฏ
2. ูุฌุจ ุฃู ูุง ูุธูุฑ ุฒุฑ "ุจุฏุก ููุงููุฉ ุงูููุฏูู"

#### ุฌ) ุงุฎุชุจุงุฑ ููุนุฏ ุบูุฑ ูุคูุฏ
1. ุฃูุดุฆ ููุนุฏ ุฌุฏูุฏ
2. ูุง ุชุคูุฏ ุงูููุนุฏ (ุงุชุฑูู PENDING_CONFIRM)
3. ูุฌุจ ุฃู ูุง ูุธูุฑ ุฒุฑ "ุจุฏุก ููุงููุฉ ุงูููุฏูู"

#### ุฏ) ุงุฎุชุจุงุฑ ููุนุฏ ูู ููุน ุขุฎุฑ
1. ุฃูุดุฆ ููุนุฏ ูู ููุน IN_PERSON ุฃู CHAT
2. ูุฌุจ ุฃู ูุง ูุธูุฑ ุฒุฑ "ุจุฏุก ููุงููุฉ ุงูููุฏูู"

### ุงูุณููุงุฑูู 4: ุงุฎุชุจุงุฑ Permissions

#### ุฃ) ููู Android
1. ุงุฐูุจ ุฅูู ุฅุนุฏุงุฏุงุช ุงูุชุทุจูู
2. ุฃูุบู ุตูุงุญูุฉ ุงููุงููุฑุง
3. ุญุงูู ุจุฏุก ููุงููุฉ
4. ูุฌุจ ุฃู ูุทูุจ ุงูุชุทุจูู ุตูุงุญูุฉ ุงููุงููุฑุง

#### ุจ) ููู iOS
1. ุงุฐูุจ ุฅูู ุฅุนุฏุงุฏุงุช iOS > ุงูุฎุตูุตูุฉ > ุงููุงููุฑุง
2. ุฃูุบู ุตูุงุญูุฉ ุงููุงููุฑุง ููุชุทุจูู
3. ุญุงูู ุจุฏุก ููุงููุฉ
4. ูุฌุจ ุฃู ูุทูุจ ุงูุชุทุจูู ุตูุงุญูุฉ ุงููุงููุฑุง

## ุงูุชุญูู ูู ุงูุฃุฎุทุงุก

### 1. ูุญุต Console Logs

ุฑุงูุจ ุงูู logs ุฃุซูุงุก ุงูุงุฎุชุจุงุฑ:

```bash
flutter run
```

ุงุจุญุซ ุนู:
- `โ Agora engine initialized successfully`
- `โ Joined channel successfully`
- `๐ค User joined: <uid>`
- ุฃู ุฑุณุงุฆู ุฎุทุฃ ุชุจุฏุฃ ุจู `โ`

### 2. ูุญุต Network Requests

ุฑุงูุจ ุทูุจุงุช API:
- `GET /sessions/video/app-id` - ููุญุตูู ุนูู App ID
- `POST /sessions/video/token` - ููุญุตูู ุนูู Token
- `POST /sessions/video/{appointmentId}/join` - ููุงูุถูุงู

### 3. ุงููุดุงูู ุงูุดุงุฆุนุฉ

#### ุงููุดููุฉ: "ุฎุฏูุฉ Agora ุบูุฑ ููุนูุฉ"
**ุงูุญู:**
- ุชุญูู ูู ุฅุนุฏุงุฏุงุช Agora ูู ุงูุจุงููุฏ
- ุชุฃูุฏ ูู ุฃู `isEnabled: true`
- ุชุฃูุฏ ูู ุตุญุฉ App ID ู Certificate

#### ุงููุดููุฉ: "ูุง ูููู ุจุฏุก ููุงููุฉ ุงูููุฏูู ุงูุขู"
**ุงูุญู:**
- ุชุญูู ูู ุฃู ุงูููุนุฏ ูุคูุฏ (CONFIRMED)
- ุชุญูู ูู ุงูููุช (ูุฌุจ ุฃู ูููู ุถูู 10 ุฏูุงุฆู ูุจู ุงูููุนุฏ)
- ุชุญูู ูู ุฃู ููุน ุงูููุนุฏ = VIDEO

#### ุงููุดููุฉ: "ูุดู ูู ุชููุฆุฉ ูุญุฑู ุงูููุฏูู"
**ุงูุญู:**
- ุชุญูู ูู ุฅุนุฏุงุฏุงุช Permissions ูู AndroidManifest.xml ู Info.plist
- ุชุฃูุฏ ูู ุชุซุจูุช agora_rtc_engine: `flutter pub get`
- ุชุฃูุฏ ูู ุฃู App ID ุตุญูุญ

#### ุงููุดููุฉ: ูุง ูุธูุฑ ุงูููุฏูู ุงูุจุนูุฏ
**ุงูุญู:**
- ุชุฃูุฏ ูู ุฃู ุงูุทุฑู ุงูุขุฎุฑ ุงูุถู ููููุงุฉ
- ุชุญูู ูู ุฃู ุงููุงููุฑุง ููุนูุฉ ููุทุฑู ุงูุขุฎุฑ
- ุชุญูู ูู ุงูุงุชุตุงู ุจุงูุฅูุชุฑูุช

#### ุงููุดููุฉ: ูุง ุชุธูุฑ ุงููุงููุฑุง ุงููุญููุฉ
**ุงูุญู:**
- ุชุญูู ูู ุตูุงุญูุงุช ุงููุงููุฑุง
- ุชุฃูุฏ ูู ุฃู ุงููุงููุฑุง ุบูุฑ ูุณุชุฎุฏูุฉ ูู ุชุทุจูู ุขุฎุฑ
- ุฃุนุฏ ุชุดุบูู ุงูุชุทุจูู

## ุงุฎุชุจุงุฑ ุนูู ุฃุฌูุฒุฉ ุญููููุฉ

### ููุงุฎุชุจุงุฑ ุงููุงููุ ูููุตุญ ุจุงูุงุฎุชุจุงุฑ ุนูู:

1. **ุฌูุงุฒูู Android ุญูููููู**
   - ุฌูุงุฒ ููุทุจูุจ
   - ุฌูุงุฒ ูููุฑูุถ

2. **ุฌูุงุฒ Android + iOS**
   - ููุชุญูู ูู ุงูุชูุงูู ุนุจุฑ ุงูููุตุงุช

3. **ุดุจูุฉ Wi-Fi ูุณุชูุฑุฉ**
   - ููุงููุงุช ุงูููุฏูู ุชุญุชุงุฌ ุงุชุตุงู ุฅูุชุฑูุช ุฌูุฏ
   - ุชุฌูุจ ุงุณุชุฎุฏุงู ุงูุจูุงูุงุช ุงูุฎูููุฉ ููุงุฎุชุจุงุฑ ุงูุฃููู

## Checklist ููุงุฎุชุจุงุฑ

### ูุจู ุงูุงุฎุชุจุงุฑ:
- [ ] Agora ููุนู ูู ุงูุจุงููุฏ
- [ ] App ID ู Certificate ุตุญูุญุฉ
- [ ] ุงูุจุงููุฏ ูุนูู ููููู ุงููุตูู ุฅููู
- [ ] ุชู ุชุซุจูุช ุงูุญุฒู (`flutter pub get`)
- [ ] Permissions ุตุญูุญุฉ ูู Android/iOS

### ุฃุซูุงุก ุงูุงุฎุชุจุงุฑ:
- [ ] ูููู ุจุฏุก ููุงููุฉ ููุฏูู
- [ ] ูุธูุฑ ุงูููุฏูู ุงููุญูู
- [ ] ูููู ุงูุงูุถูุงู ูู ุฌูุงุฒ ุขุฎุฑ
- [ ] ูุธูุฑ ุงูููุฏูู ุงูุจุนูุฏ
- [ ] ูููู ูุชู/ุฅูุบุงุก ูุชู ุงููููุฑูููู
- [ ] ูููู ุชุดุบูู/ุฅููุงู ุงููุงููุฑุง
- [ ] ูููู ุชุจุฏูู ุงููุงููุฑุง
- [ ] ูููู ุฅููุงุก ุงูููุงููุฉ
- [ ] ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุชุนูู ุจุดูู ุตุญูุญ

### ุจุนุฏ ุงูุงุฎุชุจุงุฑ:
- [ ] ุชู ุชูุธูู ุงูููุงุฑุฏ ุจุดูู ุตุญูุญ
- [ ] ูุง ุชูุฌุฏ memory leaks
- [ ] ุงูุชุทุจูู ูุนูู ุจุดูู ุทุจูุนู ุจุนุฏ ุงูููุงููุฉ

## ูุตุงุฆุญ ุฅุถุงููุฉ

1. **ููุงุฎุชุจุงุฑ ุงูุณุฑูุน**: ุงุณุชุฎุฏู ูุญุงูููู (emulators) ููู ูู ูููู ููุงู ููุฏูู ุญูููู

2. **ููุงุฎุชุจุงุฑ ุงููุงูู**: ุงุณุชุฎุฏู ุฃุฌูุฒุฉ ุญููููุฉ

3. **ููุงุฎุชุจุงุฑ ุชุญุช ุธุฑูู ูุฎุชููุฉ**:
   - ุดุจูุฉ Wi-Fi ุถุนููุฉ
   - ุดุจูุฉ 4G/5G
   - ุชุจุฏูู ุจูู ุงูุดุจูุงุช ุฃุซูุงุก ุงูููุงููุฉ

4. **ูููุงุณ ุงูุฃุฏุงุก**:
   - ุฑุงูุจ ุงุณุชุฎุฏุงู CPU ู Memory
   - ุฑุงูุจ ุงุณุชููุงู ุงูุจุทุงุฑูุฉ
   - ุฑุงูุจ ุงุณุชููุงู ุงูุจูุงูุงุช

## ุงูุฏุนู ุงูููู

ุฅุฐุง ูุงุฌูุช ูุดุงูู:
1. ุชุญูู ูู logs ูู Console
2. ุชุญูู ูู Network requests ูู DevTools
3. ุฑุงุฌุน [AGORA_SETUP_GUIDE.md](../new/AGORA_SETUP_GUIDE.md) ูู ุงูุจุงููุฏ
4. ุชุญูู ูู ูุซุงุฆู Agora: https://docs.agora.io/

## ููุงุญุธุงุช ูููุฉ

- **ููุงุฎุชุจุงุฑ ูู Production**: ูุฌุจ ุฃู ูููู ูุฏูู Agora account ูุฏููุน
- **ููุงุฎุชุจุงุฑ ูู Development**: ูููู ุงุณุชุฎุฏุงู Agora account ูุฌุงูู (ูุน ูููุฏ)
- **Token Expiration**: Tokens ุชูุชูู ุจุนุฏ ุณุงุนุฉ (ุงูุชุฑุงุถูุงู)
- **Time Window**: ูููู ุงูุงูุถูุงู ููุท ูุจู 10 ุฏูุงุฆู ูู ุงูููุนุฏ ุญุชู ุงูุชูุงุฆู







